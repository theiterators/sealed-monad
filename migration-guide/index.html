<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Migration Guide | Sealed Monad Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://theiterators.github.io/sealed-monad/migration-guide"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Migration Guide | Sealed Monad Documentation"><meta data-react-helmet="true" name="description" content="This guide provides step-by-step instructions for migrating existing code to use Sealed Monad. Whether you&#x27;re currently using nested pattern matching, EitherT, or another approach, this guide will help you transition smoothly."><meta data-react-helmet="true" property="og:description" content="This guide provides step-by-step instructions for migrating existing code to use Sealed Monad. Whether you&#x27;re currently using nested pattern matching, EitherT, or another approach, this guide will help you transition smoothly."><link data-react-helmet="true" rel="icon" href="/sealed-monad/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://theiterators.github.io/sealed-monad/migration-guide"><link data-react-helmet="true" rel="alternate" href="https://theiterators.github.io/sealed-monad/migration-guide" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://theiterators.github.io/sealed-monad/migration-guide" hreflang="x-default"><link rel="stylesheet" href="/sealed-monad/assets/css/styles.ce1d0174.css">
<link rel="preload" href="/sealed-monad/assets/js/runtime~main.a5490e7f.js" as="script">
<link rel="preload" href="/sealed-monad/assets/js/main.15292e1b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sealed-monad/"><div class="navbar__logo"><img src="/sealed-monad/img/favicon.ico" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/sealed-monad/img/favicon.ico" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Sealed Monad</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sealed-monad/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/theiterators/sealed-monad" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/">Introduction to Sealed Monad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/motivations">Motivations &amp; Core Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/installation">Installation Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/usecases">Practical Use Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/api-reference">API Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/best-practices">Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/comparison">Comparison with Other Approaches</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/sealed-monad/migration-guide">Migration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/faq">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sealed-monad/conclusion">Conclusion</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migration Guide</h1></header><p>This guide provides step-by-step instructions for migrating existing code to use Sealed Monad. Whether you&#x27;re currently using nested pattern matching, EitherT, or another approach, this guide will help you transition smoothly.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="migrating-from-pattern-matching">Migrating from Pattern Matching<a class="hash-link" href="#migrating-from-pattern-matching" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re currently using nested pattern matching with Options or Either, here&#x27;s how to migrate to Sealed Monad.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="before">Before:<a class="hash-link" href="#before" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">def confirmEmail(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  token: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findAuthMethod: String =&gt; Future[Option[AuthMethod]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findUser: Long =&gt; Future[Option[User]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  upsertAuthMethod: AuthMethod =&gt; Future[Int],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  issueTokenFor: User =&gt; String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  confirmMethod: AuthMethod =&gt; AuthMethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Future[ConfirmResponse] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findAuthMethod(token).flatMap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case None =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Future.successful(ConfirmResponse.MethodNotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Some(method) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      findUser(method.userId).flatMap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        case None =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Future.successful(ConfirmResponse.UserNotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        case Some(user) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          upsertAuthMethod(confirmMethod(method)).map { _ =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ConfirmResponse.Confirmed(issueTokenFor(user))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="migration-steps">Migration Steps:<a class="hash-link" href="#migration-steps" title="Direct link to heading">â€‹</a></h3><ol><li><strong>Identify the result ADT</strong>: Make sure you have a sealed trait hierarchy for the responses.</li></ol><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed trait ConfirmResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object ConfirmResponse {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case object MethodNotFound extends ConfirmResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case object UserNotFound extends ConfirmResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final case class Confirmed(token: String) extends ConfirmResponse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li><strong>Import the Sealed Monad syntax</strong>: Add the import at the top of your file.</li></ol><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import pl.iterators.sealedmonad.syntax._</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li><p><strong>Identify the pattern matching branches</strong>: Look for places where you&#x27;re pattern matching on Option/Either results.</p></li><li><p><strong>Rewrite using Sealed Monad operators</strong>:</p><ul><li>Use <code>valueOr</code> for Option extraction</li><li>Use <code>ensure</code> for conditional checks</li><li>Use <code>attempt</code> for Either conversion</li></ul></li><li><p><strong>Structure as a for-comprehension</strong>: Put the steps in a for-comprehension.</p></li><li><p><strong>Add the .run call</strong>: Complete the computation with <code>.run</code>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="after">After:<a class="hash-link" href="#after" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">def confirmEmail(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  token: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findAuthMethod: String =&gt; Future[Option[AuthMethod]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findUser: Long =&gt; Future[Option[User]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  upsertAuthMethod: AuthMethod =&gt; Future[Int],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  issueTokenFor: User =&gt; String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  confirmMethod: AuthMethod =&gt; AuthMethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Future[ConfirmResponse] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Find auth method or return MethodNotFound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method &lt;- findAuthMethod(token)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .valueOr[ConfirmResponse](ConfirmResponse.MethodNotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Find user or return UserNotFound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user &lt;- findUser(method.userId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .valueOr[ConfirmResponse](ConfirmResponse.UserNotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Update auth method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- upsertAuthMethod(confirmMethod(method)).seal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } yield ConfirmResponse.Confirmed(issueTokenFor(user))).run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="migrating-from-tryeitherexception-handling">Migrating from Try/Either/Exception Handling<a class="hash-link" href="#migrating-from-tryeitherexception-handling" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re using traditional Try/Either or exception handling, follow these steps:</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="before-1">Before:<a class="hash-link" href="#before-1" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">def processOrder(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orderId: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orderRepository: OrderRepository,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  paymentService: PaymentService,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shippingService: ShippingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Future[OrderProcessingResult] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.util.{Success, Failure}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orderRepository.findById(orderId).flatMap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case None =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Future.successful(OrderProcessingResult.NotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Some(order) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (order.isExpired) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Future.successful(OrderProcessingResult.Expired)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        paymentService.processPayment(order.id, order.amount).flatMap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          case Success(paymentId) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            shippingService.arrangeShipping(order).transform {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              case Success(trackingId) =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Success(OrderProcessingResult.Completed(trackingId))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              case Failure(_) =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Success(OrderProcessingResult.ShippingFailed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          case Failure(e: InsufficientFundsException) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Future.successful(OrderProcessingResult.InsufficientFunds)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          case Failure(_) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Future.successful(OrderProcessingResult.PaymentFailed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="migration-steps-1">Migration Steps:<a class="hash-link" href="#migration-steps-1" title="Direct link to heading">â€‹</a></h3><ol><li><p><strong>Define your ADT</strong>: Ensure your result type is a sealed trait with all possible outcomes.</p></li><li><p><strong>Restructure as a linear flow</strong>: Identify the steps and convert to a for-comprehension.</p></li><li><p><strong>Use appropriate operators</strong>: Replace conditionals with <code>ensure</code>, exceptions with <code>attempt</code>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="after-1">After:<a class="hash-link" href="#after-1" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">def processOrder(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orderId: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  orderRepository: OrderRepository,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  paymentService: PaymentService,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shippingService: ShippingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Future[OrderProcessingResult] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import pl.iterators.sealedmonad.syntax._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Find order or return NotFound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    order &lt;- orderRepository.findById(orderId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .valueOr[OrderProcessingResult](OrderProcessingResult.NotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Check if order is expired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- order.pure[Future]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .ensure(!_.isExpired, OrderProcessingResult.Expired)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Process payment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paymentId &lt;- paymentService.processPayment(order.id, order.amount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  .attempt {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    case Success(id) =&gt; Right(id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    case Failure(e: InsufficientFundsException) =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      Left(OrderProcessingResult.InsufficientFunds)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    case Failure(_) =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      Left(OrderProcessingResult.PaymentFailed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Arrange shipping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    trackingId &lt;- shippingService.arrangeShipping(order)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   .attempt {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     case Success(id) =&gt; Right(id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     case Failure(_) =&gt; Left(OrderProcessingResult.ShippingFailed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } yield OrderProcessingResult.Completed(trackingId)).run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="gradual-migration-strategy">Gradual Migration Strategy<a class="hash-link" href="#gradual-migration-strategy" title="Direct link to heading">â€‹</a></h2><p>When migrating a large codebase, consider this gradual approach:</p><ol><li><p><strong>Start with leaf methods</strong>: Begin with methods that don&#x27;t depend on other methods returning ADTs.</p></li><li><p><strong>Create ADT wrappers</strong>: For methods you&#x27;re not ready to migrate, create wrappers that return the appropriate ADT.</p></li></ol><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">// Original method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def findUser(id: String): Future[Option[User]] = ???</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Wrapper for use with Sealed Monad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def findUserOrError(id: String): Future[UserResponse] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findUser(id).map(_.fold[UserResponse](UserResponse.NotFound)(UserResponse.Found))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li><p><strong>Migrate core business logic first</strong>: Focus on complex business logic with multiple error cases first, as these will benefit most from Sealed Monad.</p></li><li><p><strong>Update tests</strong>: Make sure to update tests to verify both success and failure paths.</p></li><li><p><strong>Refactor in small, focused PRs</strong>: Don&#x27;t try to migrate everything at once. Focus on small, manageable pull requests.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="mixing-sealed-monad-with-other-approaches">Mixing Sealed Monad with Other Approaches<a class="hash-link" href="#mixing-sealed-monad-with-other-approaches" title="Direct link to heading">â€‹</a></h2><p>During migration, you might need to mix Sealed Monad with existing approaches:</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="integrating-with-eithert">Integrating with EitherT<a class="hash-link" href="#integrating-with-eithert" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import cats.data.EitherT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import cats.implicits._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import pl.iterators.sealedmonad.Sealed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import pl.iterators.sealedmonad.syntax._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Convert from EitherT to Sealed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def fromEitherT[F[_], A, B](eitherT: EitherT[F, B, A])(implicit M: Monad[F]): Sealed[F, A, B] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Sealed(eitherT.value).rethrow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Convert from Sealed to EitherT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def toEitherT[F[_]: Monad, A, B](sealed: Sealed[F, A, B]): EitherT[F, B, A] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EitherT(sealed.either.run)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="integrating-with-option-returning-functions">Integrating with Option-returning functions<a class="hash-link" href="#integrating-with-option-returning-functions" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">// When calling external code that returns Option</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def callLegacyCode(id: String): Sealed[F, User, UserError] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  legacyService.findUserById(id).valueOr(UserError.NotFound)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="example-migrating-a-service-class">Example: Migrating a Service Class<a class="hash-link" href="#example-migrating-a-service-class" title="Direct link to heading">â€‹</a></h2><p>Here&#x27;s a complete example of migrating a service class:</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="before-2">Before:<a class="hash-link" href="#before-2" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">class OrderService(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repository: OrderRepository,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  paymentService: PaymentService,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  notificationService: NotificationService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def placeOrder(userId: String, items: List[OrderItem]): Future[Either[String, Order]] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (items.isEmpty) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return Future.successful(Left(&quot;Order must contain at least one item&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repository.findActiveCartByUser(userId).flatMap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case None =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Future.successful(Left(&quot;No active cart found&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case Some(cart) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (cart.items.isEmpty) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Future.successful(Left(&quot;Cart is empty&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          val order = Order(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            id = generateOrderId(), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            userId = userId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            items = cart.items,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status = &quot;pending&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            createdAt = Instant.now()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          repository.createOrder(order).flatMap { createdOrder =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            paymentService.processPayment(userId, calculateTotal(cart.items)).flatMap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              case Right(paymentId) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                val finalOrder = createdOrder.copy(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  paymentId = Some(paymentId),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  status = &quot;paid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                repository.updateOrder(finalOrder).flatMap { updatedOrder =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  notificationService.sendOrderConfirmation(updatedOrder)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .map(_ =&gt; Right(updatedOrder))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              case Left(error) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Future.successful(Left(s&quot;Payment failed: $error&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private def calculateTotal(items: List[OrderItem]): BigDecimal = </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    items.map(item =&gt; item.price * item.quantity).sum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private def generateOrderId(): String = </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s&quot;ORD-${System.currentTimeMillis()}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="after-2">After:<a class="hash-link" href="#after-2" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed trait OrderResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object OrderResult {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case class Success(order: Order) extends OrderResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case object EmptyItems extends OrderResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case object NoActiveCart extends OrderResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case object EmptyCart extends OrderResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case class PaymentFailed(reason: String) extends OrderResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class OrderService(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repository: OrderRepository,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  paymentService: PaymentService,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  notificationService: NotificationService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import pl.iterators.sealedmonad.syntax._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def placeOrder(userId: String, items: List[OrderItem]): Future[OrderResult] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Validate items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _ &lt;- items.pure[Future]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .ensure(_.nonEmpty, OrderResult.EmptyItems)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Find active cart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cart &lt;- repository.findActiveCartByUser(userId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .valueOr[OrderResult](OrderResult.NoActiveCart)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Validate cart items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _ &lt;- cart.pure[Future]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .ensure(_.items.nonEmpty, OrderResult.EmptyCart)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Create order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      order = Order(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id = generateOrderId(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userId = userId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        items = cart.items,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = &quot;pending&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        createdAt = Instant.now()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Save order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      createdOrder &lt;- repository.createOrder(order).seal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Process payment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      paymentId &lt;- paymentService.processPayment(userId, calculateTotal(cart.items))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .attempt {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      case Right(id) =&gt; Right(id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      case Left(error) =&gt; Left(OrderResult.PaymentFailed(error))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Update order with payment info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      finalOrder = createdOrder.copy(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        paymentId = Some(paymentId),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        status = &quot;paid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Save updated order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      updatedOrder &lt;- repository.updateOrder(finalOrder).seal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Send confirmation notification</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _ &lt;- notificationService.sendOrderConfirmation(updatedOrder).seal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } yield OrderResult.Success(updatedOrder)).run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private def calculateTotal(items: List[OrderItem]): BigDecimal = </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    items.map(item =&gt; item.price * item.quantity).sum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private def generateOrderId(): String = </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s&quot;ORD-${System.currentTimeMillis()}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="final-checklist">Final Checklist<a class="hash-link" href="#final-checklist" title="Direct link to heading">â€‹</a></h2><p>Before considering a migration complete, ensure you&#x27;ve:</p><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Imported <code>pl.iterators.sealedmonad.syntax._</code> wherever needed</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Replaced all pattern matching with Sealed Monad operators</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Added <code>.run</code> to execute computations</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Updated tests to verify both success and error paths</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Updated documentation to reflect the new approach</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Reviewed for readability and consistency</li></ul><p>With these steps, you should be able to successfully migrate to Sealed Monad and enjoy cleaner, more maintainable error handling in your code.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="migrating-from-eithert">Migrating from EitherT<a class="hash-link" href="#migrating-from-eithert" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re currently using Cats&#x27; EitherT, here&#x27;s how to migrate to Sealed Monad.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="before-3">Before:<a class="hash-link" href="#before-3" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">def confirmEmail(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  token: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findAuthMethod: String =&gt; Future[Option[AuthMethod]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findUser: Long =&gt; Future[Option[User]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  upsertAuthMethod: AuthMethod =&gt; Future[Int],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  issueTokenFor: User =&gt; String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  confirmMethod: AuthMethod =&gt; AuthMethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Future[ConfirmResponse] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import cats.implicits._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  val userT = for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method &lt;- EitherT.fromOptionF(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                findAuthMethod(token),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ifNone = ConfirmResponse.MethodNotFound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user &lt;- EitherT.fromOptionF(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              findUser(method.userId),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ifNone = ConfirmResponse.UserNotFound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } yield (method, user)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  userT.semiflatMap { case (method, user) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    upsertAuthMethod(confirmMethod(method))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(_ =&gt; ConfirmResponse.Confirmed(issueTokenFor(user)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }.merge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="migration-steps-2">Migration Steps:<a class="hash-link" href="#migration-steps-2" title="Direct link to heading">â€‹</a></h3><ol><li><strong>Import the Sealed Monad syntax</strong>: Add the import at the top of your file.</li></ol><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import pl.iterators.sealedmonad.syntax._</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li><p><strong>Replace EitherT operations with Sealed Monad equivalents</strong>:</p><ul><li><code>EitherT.fromOptionF(opt, ifNone)</code> â†’ <code>opt.valueOr(ifNone)</code></li><li><code>EitherT.cond(test, right, left)</code> â†’ <code>right.pure[F].ensure(_ =&gt; test, left)</code></li><li><code>eitherT.semiflatMap</code> â†’ <code>sealed.flatMap</code> or <code>sealed.flatTap</code></li><li><code>.merge</code> â†’ <code>.run</code></li></ul></li><li><p><strong>Structure as a for-comprehension</strong>: Put the steps in a for-comprehension.</p></li><li><p><strong>Add the .run call</strong>: Complete the computation with <code>.run</code>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="after-3">After:<a class="hash-link" href="#after-3" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">def confirmEmail(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  token: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findAuthMethod: String =&gt; Future[Option[AuthMethod]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  findUser: Long =&gt; Future[Option[User]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  upsertAuthMethod: AuthMethod =&gt; Future[Int],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  issueTokenFor: User =&gt; String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  confirmMethod: AuthMethod =&gt; AuthMethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Future[ConfirmResponse] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import scala.concurrent.ExecutionContext.Implicits.global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  import pl.iterators.sealedmonad.syntax._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method &lt;- findAuthMethod(token)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .valueOr[ConfirmResponse](ConfirmResponse.MethodNotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user &lt;- findUser(method.userId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .valueOr[ConfirmResponse](ConfirmResponse.UserNotFound)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- upsertAuthMethod(confirmMethod(method)).seal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } yield ConfirmResponse.Confirmed(issueTokenFor(user))).run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/theiterators/sealed-monad/tree/master/docs/../docs/migration-guide.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/sealed-monad/comparison"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Comparison with Other Approaches</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/sealed-monad/faq"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Frequently Asked Questions</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#migrating-from-pattern-matching" class="table-of-contents__link toc-highlight">Migrating from Pattern Matching</a><ul><li><a href="#before" class="table-of-contents__link toc-highlight">Before:</a></li><li><a href="#migration-steps" class="table-of-contents__link toc-highlight">Migration Steps:</a></li><li><a href="#after" class="table-of-contents__link toc-highlight">After:</a></li></ul></li><li><a href="#migrating-from-tryeitherexception-handling" class="table-of-contents__link toc-highlight">Migrating from Try/Either/Exception Handling</a><ul><li><a href="#before-1" class="table-of-contents__link toc-highlight">Before:</a></li><li><a href="#migration-steps-1" class="table-of-contents__link toc-highlight">Migration Steps:</a></li><li><a href="#after-1" class="table-of-contents__link toc-highlight">After:</a></li></ul></li><li><a href="#gradual-migration-strategy" class="table-of-contents__link toc-highlight">Gradual Migration Strategy</a></li><li><a href="#mixing-sealed-monad-with-other-approaches" class="table-of-contents__link toc-highlight">Mixing Sealed Monad with Other Approaches</a><ul><li><a href="#integrating-with-eithert" class="table-of-contents__link toc-highlight">Integrating with EitherT</a></li><li><a href="#integrating-with-option-returning-functions" class="table-of-contents__link toc-highlight">Integrating with Option-returning functions</a></li></ul></li><li><a href="#example-migrating-a-service-class" class="table-of-contents__link toc-highlight">Example: Migrating a Service Class</a><ul><li><a href="#before-2" class="table-of-contents__link toc-highlight">Before:</a></li><li><a href="#after-2" class="table-of-contents__link toc-highlight">After:</a></li></ul></li><li><a href="#final-checklist" class="table-of-contents__link toc-highlight">Final Checklist</a></li><li><a href="#migrating-from-eithert" class="table-of-contents__link toc-highlight">Migrating from EitherT</a><ul><li><a href="#before-3" class="table-of-contents__link toc-highlight">Before:</a></li><li><a href="#migration-steps-2" class="table-of-contents__link toc-highlight">Migration Steps:</a></li><li><a href="#after-3" class="table-of-contents__link toc-highlight">After:</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sealed-monad/">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/iteratorshq" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/theiterators/sealed-monad" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 <a href="https://www.iteratorshq.com">Iterators</a> sp. z o.o.</div></div></div></footer></div>
<script src="/sealed-monad/assets/js/runtime~main.a5490e7f.js"></script>
<script src="/sealed-monad/assets/js/main.15292e1b.js"></script>
</body>
</html>